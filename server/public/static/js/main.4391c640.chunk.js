(this["webpackJsonpcamilo-client"]=this["webpackJsonpcamilo-client"]||[]).push([[0],{12:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),l=a(2);var o=function(e){let{label:t,icon:a,onClick:r,disabled:l}=e;return n.a.createElement("button",{onClick:r,disabled:l,style:{padding:"0.5rem 1rem",backgroundColor:l?"#ccc":"#007bff",color:"white",border:"none",borderRadius:"8px",cursor:l?"not-allowed":"pointer",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"}},n.a.createElement("span",{role:"img","aria-label":"icon"},a),t)};var i=function(e){let{label:t,value:a,onChange:r,options:l,placeholder:o,required:i=!1,displayField:c="nombre"}=e;return n.a.createElement("div",{style:{marginBottom:"1rem"}},n.a.createElement("label",null,t,":"),n.a.createElement("select",{value:a,onChange:r,required:i,style:{width:"100%",padding:"0.5rem"}},n.a.createElement("option",{disabled:!0,value:""},o),l.map(e=>n.a.createElement("option",{key:e.id,value:e.id},e[c]||"(Sin nombre)"))))};var c=function(e){let{mode:t="crear",initialData:a={},onCancel:l,onSubmit:c}=e;const[d,m]=Object(r.useState)(a.name||""),[s,u]=Object(r.useState)(a.code||""),[p,g]=Object(r.useState)(a.lineaProductivaId||""),[b,f]=Object(r.useState)(a.lineaComercial1Id||""),[h,E]=Object(r.useState)(a.lineaComercial2Id||""),[v,y]=Object(r.useState)([]),[x,C]=Object(r.useState)([]);return Object(r.useEffect)(()=>{fetch("/api/lineasproductivas").then(e=>e.json()).then(e=>y(e)).catch(e=>console.error("Error cargando l\xedneas productivas",e)),fetch("/api/lineascomerciales").then(e=>e.json()).then(e=>C(e)).catch(e=>console.error("Error cargando l\xedneas comerciales",e))},[]),n.a.createElement("form",{onSubmit:e=>{if(e.preventDefault(),!d.trim()||!s.trim())return void alert("Nombre y c\xf3digo son obligatorios");if("referencia"===t&&!s.includes("-"))return void alert("El c\xf3digo de la referencia debe incluir un guion (ej: 123-1)");c({name:d,code:s,lineaProductivaId:p,lineaComercial1Id:b,lineaComercial2Id:h})}},n.a.createElement("div",{style:{marginBottom:"1rem"}},n.a.createElement("label",null,"Nombre:"),n.a.createElement("input",{value:d,onChange:e=>m(e.target.value),style:{width:"100%",padding:"0.5rem"}})),n.a.createElement("div",{style:{marginBottom:"1rem"}},n.a.createElement("label",null,"C\xf3digo:"),n.a.createElement("input",{value:s,onChange:e=>u(e.target.value),style:{width:"100%",padding:"0.5rem"}})),n.a.createElement(i,{label:"L\xednea Productiva",value:p,onChange:e=>g(e.target.value),options:v,placeholder:"Selecciona una l\xednea productiva",required:!0,displayField:"nombre"}),n.a.createElement(i,{label:"L\xednea Comercial 1",value:b,onChange:e=>f(e.target.value),options:x,placeholder:"Selecciona una l\xednea comercial",displayField:"nombre"}),n.a.createElement(i,{label:"L\xednea Comercial 2",value:h,onChange:e=>E(e.target.value),options:x,placeholder:"Selecciona una l\xednea comercial",displayField:"nombre"}),n.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",gap:"1rem",marginTop:"2rem"}},n.a.createElement(o,{onClick:l,type:"button"},"Cancelar"),n.a.createElement(o,{type:"submit"},"editar"===t?"Actualizar":"Guardar")))};var d=function(){const[e,t]=Object(r.useState)(""),[a,l]=Object(r.useState)(""),[i,d]=Object(r.useState)(!1),[m,s]=Object(r.useState)(null),{products:u,loading:p,hasMore:g,lastProductRef:b}=function(e){let{search:t="",linea:a="",limit:n=50}=e;const[l,o]=Object(r.useState)([]),[i,c]=Object(r.useState)(1),[d,m]=Object(r.useState)(!1),[s,u]=Object(r.useState)(!0),p=Object(r.useRef)(),g=Object(r.useCallback)(e=>{d||(p.current&&p.current.disconnect(),p.current=new IntersectionObserver(e=>{e[0].isIntersecting&&s&&c(e=>e+1)}),e&&p.current.observe(e))},[d,s]);return Object(r.useEffect)(()=>{o([]),c(1),u(!0)},[t,a]),Object(r.useEffect)(()=>{m(!0),fetch(`/api/products/paginated?search=${encodeURIComponent(t)}&linea=${encodeURIComponent(a)}&page=${i}&limit=${n}`).then(e=>e.json()).then(e=>{o(t=>[...t,...e.data]),u(e.data.length===n),m(!1)}).catch(e=>{console.error("\u274c Error al cargar productos:",e),m(!1)})},[i,t,a,n]),{products:l,loading:d,hasMore:s,lastProductRef:g}}({search:e,linea:a,limit:50});return n.a.createElement("div",{style:{padding:"2rem"}},n.a.createElement("h1",null,"Camilo Production System"),n.a.createElement("h2",null,"Product Manager"),n.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",gap:"1rem",marginBottom:"1rem"}},n.a.createElement(o,{onClick:()=>d(!0)},n.a.createElement("span",{role:"img","aria-label":"crear"},"\u2795")," Crear Producto"),n.a.createElement(o,{onClick:()=>alert("Abrir modal para crear referencia"),disabled:!m,title:m?"":"Selecciona un producto para agregar una referencia"},n.a.createElement("span",{role:"img","aria-label":"referencia"},"\ud83d\udd17")," Agregar Referencia")),n.a.createElement("div",{style:{marginBottom:"1rem"}},n.a.createElement("input",{type:"text",placeholder:"Buscar por nombre, c\xf3digo o categor\xeda...",value:e,onChange:e=>t(e.target.value),style:{padding:"0.5rem 1rem",fontSize:"1rem",borderRadius:"8px",border:"1px solid #ccc",width:"100%",maxWidth:"400px",marginBottom:"1rem"}}),n.a.createElement("input",{type:"text",placeholder:"Filtrar por l\xednea",value:a,onChange:e=>l(e.target.value),style:{padding:"0.5rem 1rem",fontSize:"1rem",borderRadius:"8px",border:"1px solid #ccc",width:"100%",maxWidth:"400px"}})),n.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1.5rem"}},u.map((e,t)=>{var a;const r=t===u.length-1;return n.a.createElement("div",{key:e.crce7_t_productosid||t,ref:r?b:null,onClick:()=>s(e.crce7_t_productosid),style:{border:m===e.crce7_t_productosid?"2px solid #007bff":"1px solid #ddd",borderRadius:"12px",padding:"1rem",boxShadow:"0 2px 6px rgba(0,0,0,0.1)",cursor:"pointer",backgroundColor:m===e.crce7_t_productosid?"#f0f8ff":"white"}},n.a.createElement("h3",{style:{margin:"0.5rem 0 0.25rem"}},e.crce7_nombre_),n.a.createElement("p",{style:{margin:"0.25rem 0",color:"#888"}},"C\xf3digo: ",n.a.createElement("strong",null,e.crce7_codigo)),n.a.createElement("p",{style:{fontWeight:"bold",fontSize:"1rem",marginTop:"0.5rem"}},"Precio: $",(null===(a=e.crce7_precio_unitario)||void 0===a?void 0:a.toFixed(2))||"N/A"))})),p&&n.a.createElement("div",{style:{textAlign:"center",margin:"2rem"}},n.a.createElement("div",{className:"spinner",style:{border:"6px solid #f3f3f3",borderTop:"6px solid #007bff",borderRadius:"50%",width:"50px",height:"50px",animation:"spin 1s linear infinite",margin:"auto"}})),!g&&!p&&0===u.length&&n.a.createElement("div",{style:{textAlign:"center",color:"#888",fontSize:"1.1rem"}},"No se encontraron productos para mostrar."),i&&n.a.createElement("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3}},n.a.createElement("div",{style:{backgroundColor:"white",padding:"2rem",borderRadius:"12px",maxWidth:"600px",width:"90%",boxShadow:"0 4px 10px rgba(0,0,0,0.25)"}},n.a.createElement("h2",{style:{marginBottom:"1rem"}},"Crear Nuevo Producto"),n.a.createElement(c,{mode:"crear",onCancel:()=>d(!1),onSubmit:e=>{console.log("Producto creado o referencia guardada:",e),d(!1)}}))),n.a.createElement("style",null,"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      "))};var m=function(){return n.a.createElement("div",null,n.a.createElement("h1",null,"Camilo Production System"),n.a.createElement(d,null))};a.n(l).a.createRoot(document.getElementById("root")).render(n.a.createElement(m,null))},3:function(e,t,a){e.exports=a(12)}},[[3,1,2]]]);
//# sourceMappingURL=main.4391c640.chunk.js.map